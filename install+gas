#!/bin/bash

echo "=== HEMI Miner Installer ==="

# Параметры
MINER_DIR="$HOME/heminetwork_v1.0.0_linux_amd64"
MINER_PID=""
MINER_SCREEN="hemi_miner"

# Установка необходимых пакетов
sudo apt update
sudo apt install jq curl screen -y

# Проверка установки майнера
if [ -d "$MINER_DIR" ]; then
    echo "Майнер уже установлен, пропускаем установку."
else
    echo "Майнер не найден, начинаем установку..."

    # Обновление системы
    sudo apt update && sudo apt upgrade -y
    sudo apt install wget unzip nano curl jq screen -y

    # Скачиваем майнер
    wget https://github.com/hemilabs/heminetwork/releases/download/v1.0.0/heminetwork_v1.0.0_linux_amd64.tar.gz
    tar -xvzf heminetwork_v1.0.0_linux_amd64.tar.gz
    cd heminetwork_v1.0.0_linux_amd64
fi

# --- Меню ---
echo ""
echo "===== Настройка майнера ====="
read -p "Введите ваш приватный ключ BTC: " btc_key
read -p "Введите POPM_STATIC_FEE (например 4): " static_fee

# --- Генерация конфига ---
cat > config.sh <<EOF
export POPM_BTC_PRIVKEY=${
